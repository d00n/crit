#location_chooser
  %label= :country.l
  = select_tag('user[country_id]', options_from_collection_for_select(Country.all, "id", "name", selected_country))

  %p
  %label= :state.l
  = select_tag('user[state_id]', options_from_collection_for_select(states, "id", "name", (selected_state rescue nil)), {:disabled => states.empty? })

  = image_tag 'spinner.gif', :style => 'display:none;'

  %p
  %label= :metro_area.l
  = select_tag('user[metro_area_id]', options_from_collection_for_select(metro_areas, "id", "name", (selected_metro_area rescue nil)), {:disabled => metro_areas.empty? })

  = image_tag 'spinner.gif', :style => 'display:none;'

= observe_field('user_state_id', {:url => {:controller => 'users', :action => 'metro_area_update'}, :with => "'state_id=' + $('user_state_id').value + '&country_id=' + $('user_country_id').value", :loading => "$$('div#location_chooser img')[0].show();", 500 => "alert('"+:sorry_there_was_an_error.l+"'); return false", :update => "location_chooser"})

%span

= observe_field("user_country_id", {:url => {:controller => 'users', :action => 'metro_area_update'}, :with => "'country_id=' + $('user_country_id').value", :loading => "$$('div#location_chooser img')[0].show();", 500 => "alert('"+:sorry_there_was_an_error.l+"'); return false", :update => "location_chooser"})


